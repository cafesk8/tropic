{% extends '@ShopsysShop/Front/Layout/layoutWithoutPanel.html.twig' %}
{% import '@ShopsysShop/Front/Inline/Product/productFlagsMacro.html.twig' as productFlags %}
{% import '@ShopsysShop/Front/Content/Product/productListMacro.html.twig' as productList %}
{% import '@ShopsysShop/Front/Content/Product/boxDetail.html.twig' as boxDetail %}

{% set domain = getDomain() %}
{% set descriptionHeadline = 'Product information'|trans %}
{% set parametersHeadline = 'Technical parameters'|trans %}
{% set accessoriesHeadline = 'Accessories'|trans %}
{% block meta_description %}
    {{- product.getSeoMetaDescription(domain.id)|default(getSeoMetaDescription()) -}}
{% endblock %}

{% block title %}
    {{ product.getSeoTitle(domain.id)|default(product.name) }}
{% endblock %}

{% block main_content %}
    <div itemscope itemtype="http://schema.org/Product">
        <div class="js-product-variant-group">
            {{ boxDetail.productBox(product, allVariants, productMainCategory, true, mainVariants) }}

            {% for mainVariant in mainVariants if mainVariant.id != product.id %}
                {{ boxDetail.productBox(mainVariant, allVariants, productMainCategory, false, mainVariants) }}
            {% endfor %}
        </div>

        {% set productParameterValues = getProductParameterValues(product) %}
        {% if product.getDescription(domain.id)
            or productParameterValues > 0
            or accessories|length > 0
        %}
        <div class="box-detail__content">
            <div class="in-tab js-responsive-tabs">
                <div class="in-tab__head dont-print">
                    {% if product.getDescription(domain.id) %}
                        <a href="#" class="in-tab__head__item js-tabs-button active" data-tab-id="description">
                            {{ descriptionHeadline }}
                        </a>
                    {% endif %}

                    {% if accessories|length > 0 %}
                        <a href="#" class="in-tab__head__item js-tabs-button" data-tab-id="accessories">
                            {{ accessoriesHeadline }}
                        </a>
                    {% endif %}
                </div>
                <div class="in-tab__content">
                    {% if product.getDescription(domain.id) or productParameterValues > 0 %}
                        <a href="#" class="in-tab__content__title js-tabs-button active" data-tab-id="description">
                            {{ descriptionHeadline }}
                            <i class="svg svg-arrow"></i>
                        </a>
                        <div class="in-tab__content__item js-tabs-content active" data-tab-id="description">
                            <div class="in-user-text" itemprop="description">
                                {% if product.getDescription(domain.id) %}
                                    <p>
                                        {{ product.getDescription(domain.id)|raw }}
                                    </p>
                                {% endif %}
                                {% if productParameterValues > 0 %}
                                    <div class="h3">{{ parametersHeadline }}</div>
                                    <table class="table-params{% if product.getDescription(domain.id) %} margin-top-20{% endif %}">
                                        <tbody>
                                            {% for productParameterValue in productParameterValues %}
                                                <tr>
                                                    <th>
                                                        {{ productParameterValue.parameter.name }}
                                                    </th>
                                                    <td>
                                                        {{ productParameterValue.value.text }}
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}

                    {% if accessories|length > 0 %}
                        <a href="#" class="in-tab__content__title js-tabs-button" data-tab-id="accessories">
                            {{ accessoriesHeadline }}
                            <i class="svg svg-arrow"></i>
                        </a>
                        <div class="in-tab__content__item js-tabs-content" data-tab-id="accessories">
                            {{ productList.list(accessories) }}
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    {% block last_visited_products %}
        {{ render(controller('ShopsysShopBundle:Front/LastVisitedProducts:show')) }}
    {% endblock %}

{% endblock %}
