{% import 'Front/Content/Product/productAvailabilityMacro.html.twig' as availability %}

{% macro availabilityDetail(product, setDisplayNone) %}
    <div class="{% if setDisplayNone is same as (true) %}display-none {% endif %}in-availability in-availability--big js-detail-availability js-detail-availability-{{ product.id }}">
        <div class="in-availability__status">
            {{ availability.productAvailability(product) }}
        </div>

        {% set stocksWithoutZeroQuantityOnPickupPlaceStore = product.stocksWithoutZeroQuantityOnPickupPlaceStore(getDomain()) %}
        {% if stocksWithoutZeroQuantityOnPickupPlaceStore|length > 0 %}
            <span class="in-availability__text-big">
                {{ 'nebo na'|trans }}&nbsp
            </span>
            <a
                href="#"
                class="in-availability__stores-big underline-small js-detail-availability-window-opener"
                data-product-id="{{ product.id }}"
                >
                {{ 'prodejně'|trans }}
            </a>
        {% endif %}
        <div class="display-none js-availability-table_{{ product.id }}">
            <table class="table-main full-width">
                <thead>
                <tr>
                    <th>{{ 'Prodejna'|trans }}</th>
                </tr>
                </thead>
                <tbody>
                {% for storeWithStock in stocksWithoutZeroQuantityOnPickupPlaceStore %}
                    <tr>
                        <td>{{ storeWithStock.store.name }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endmacro %}


{% if product.variants|length > 0 %}
    <div class="in-availability in-availability--big js-product-variant-detail-select-info">
        <div class="in-availability__status">
            <span class="in-availability__date">
                {% if product.isMainVariant %}
                    {{ 'Pro zobrazení dostupnosti vyberte variantu'|trans }}
                {% else %}
                    {{ availability.productAvailability(product) }}
                {% endif %}
            </span>
        </div>
    </div>
{% for variant in product.variants %}
        {{ _self.availabilityDetail(variant, true) }}
    {% endfor %}
{% else %}
    {{ _self.availabilityDetail(product, false) }}
{% endif %}
